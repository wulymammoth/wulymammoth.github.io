<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Violating the Law of Demeter :: wulymammoth ‚Äî tolle fuga ad astra üöÄ ‚ú®</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="A co-worker linked to the following article describing some of JavaScript&amp;rsquo;s new features in 2020 this past week: https://www.freecodecamp.org/news/javascript-new-features-es2020/. One of the features that stood out was optional chaining.
This brings with it something that I&amp;rsquo;ve already seen in other languages that I work with, namely Ruby. This sort of convenience feature is a double-edged sword:
 good for scripting not so good for any software that is to be extended and or maintained  1."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://wulymammoth.github.io/posts/law-of-demeter/" />





<link rel="stylesheet" href="https://wulymammoth.github.io/assets/style.css">


<link rel="stylesheet" href="https://wulymammoth.github.io/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://wulymammoth.github.io/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://wulymammoth.github.io/img/favicon.png">


<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://wulymammoth.github.io/"/>

<meta name="twitter:title" content="Violating the Law of Demeter"/>
<meta name="twitter:description" content="A co-worker linked to the following article describing some of JavaScript&rsquo;s new features in 2020 this past week: https://www.freecodecamp.org/news/javascript-new-features-es2020/. One of the features that stood out was optional chaining.
This brings with it something that I&rsquo;ve already seen in other languages that I work with, namely Ruby. This sort of convenience feature is a double-edged sword:
 good for scripting not so good for any software that is to be extended and or maintained  1."/>



<meta property="og:title" content="Violating the Law of Demeter" />
<meta property="og:description" content="A co-worker linked to the following article describing some of JavaScript&rsquo;s new features in 2020 this past week: https://www.freecodecamp.org/news/javascript-new-features-es2020/. One of the features that stood out was optional chaining.
This brings with it something that I&rsquo;ve already seen in other languages that I work with, namely Ruby. This sort of convenience feature is a double-edged sword:
 good for scripting not so good for any software that is to be extended and or maintained  1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wulymammoth.github.io/posts/law-of-demeter/" />
<meta property="og:image" content="https://wulymammoth.github.io/"/>
<meta property="article:published_time" content="2020-05-23T09:44:59-07:00" />
<meta property="article:modified_time" content="2020-05-23T09:44:59-07:00" /><meta property="og:site_name" content="wulymammoth" />






  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">cat friends.txt | awk &#39;{ print &#34;hello &#34; $0 }&#39;</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/posts">Blog</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/posts">Blog</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://wulymammoth.github.io/posts/law-of-demeter/">Violating the Law of Demeter</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2020-05-23
        </span>

        
          
        
      

      
      
    </div>

    
      <span class="post-tags">
        
          #<a href="https://wulymammoth.github.io/tags/solid/">solid</a>&nbsp;
        
          #<a href="https://wulymammoth.github.io/tags/lod/">lod</a>&nbsp;
        
          #<a href="https://wulymammoth.github.io/tags/law-of-demeter/">law of demeter</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <p>A co-worker linked to the following article describing some of JavaScript&rsquo;s new features in 2020 this past week: <a href="https://www.freecodecamp.org/news/javascript-new-features-es2020/">https://www.freecodecamp.org/news/javascript-new-features-es2020/</a>. One of the features that stood out was <strong>optional chaining</strong>.</p>
<p>This brings with it something that I&rsquo;ve already seen in other languages that I work with, namely Ruby. This sort of convenience feature is a double-edged sword:</p>
<ol>
<li>good for scripting</li>
<li>not so good for any software that is to be extended and or maintained</li>
</ol>
<h2 id="1-_why_-is-it-good-for-scripting">1. <em>why</em> is it good for scripting?</h2>
<p>Instead of the verbosity below:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">foo</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">foo</span>.<span style="color:#a6e22e">bar</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">foo</span>.<span style="color:#a6e22e">bar</span>.<span style="color:#a6e22e">baz</span>) <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">foo</span>.<span style="color:#a6e22e">bar</span>.<span style="color:#a6e22e">baz</span>);

<span style="color:#75715e">// -OR- ü§Æ
</span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">foo</span>) {
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">foo</span>.<span style="color:#a6e22e">bar</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">foo</span>.<span style="color:#a6e22e">bar</span>.<span style="color:#a6e22e">baz</span>) {
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">foo</span>.<span style="color:#a6e22e">bar</span>.<span style="color:#a6e22e">baz</span>);
    }
  }
}
</code></pre></div><p>We have this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">foo</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">bar</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">baz</span><span style="color:#f92672">?</span>);
</code></pre></div><p>Look at how concise that is!</p>
<p>Scripts are typically one-offs and/or throw-away code that likely won&rsquo;t be used again once time moves forward. It isn&rsquo;t always the case, of course. Sometimes we just have to do things that are quick and dirty in scenarios where we are scripting and don&rsquo;t own the content and/or data that we are traversing. Because we aren&rsquo;t the owners, the schema/shape of the data/objects that we want to navigate are opaque to us, therefore subjecting us to defensive programming practices to ensure that we don&rsquo;t have runtime exceptions that halt our script.</p>
<p>That said, the terseness of the new feature makes our script much more readable and removes possible blocks of indentation from conditional logic.</p>
<h2 id="2-_why_-isnt-it-so-good-for-any-real-software">2. <em>why</em> isn&rsquo;t it so good for any real software?</h2>
<p><strong>The TL;DR : tight-coupling and implicit dependencies</strong></p>
<p>I don&rsquo;t really see a difference between new and professional software developers with years of experience. Some of us are lucky enough to learn it from the job, but many of us don&rsquo;t. I&rsquo;m not a classically trained computer scientist or software developer &ndash; I&rsquo;m primarily self-taught. Being a software developer, I&rsquo;m always seeking to reduce pain, because going into any existing organization almost always involves some maintenance work - fixing legacy systems or extending them in addition to any greenfield work. The only way to become good at this is to be cognizant and to seek answeres. It&rsquo;s okay to go, <em>&ldquo;WTF wrote this shit?&quot;</em> momentarily, but not exacerbate the problem by piling onto it and/or following a terrible example &ndash; because any code that we commit becomes an example someone else will likely follow. It&rsquo;s usually the <em>easy</em> thing to do, but it&rsquo;s not the <em>simple</em> thing &ndash; see Rich Hickey&rsquo;s <a href="https://youtu.be/oytL881p-nQ">&ldquo;Simple Made Easy&rdquo;</a> talk.</p>
<p>We commit the same mistakes over and over creating insurmountable technical debt for their future selves and the people that will eventually come to maintain and/or extend their code.</p>
<p>In almost all organizations that I&rsquo;ve been at, the following conversation almost always comes up:</p>
<blockquote>
<p><em>In order for us to build this feature, we need a sprint to refactor our code, because we weren&rsquo;t aware of this use case</em></p>
</blockquote>
<p>This saddens me, because we made assumptions about our software that make it too rigid to let us extend existing work with new features.</p>
<p>Without digressing too far, let&rsquo;s get back to why something that seems to be a welcome and even nice addition to the language, may get us into trouble&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UsaAddress</span> {
  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">street</span>, <span style="color:#a6e22e">state</span>, <span style="color:#a6e22e">country</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">street</span>  <span style="color:#f92672">=</span> <span style="color:#a6e22e">street</span>;
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">state</span>   <span style="color:#f92672">=</span> <span style="color:#a6e22e">state</span>;
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">country</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;United States of America&#34;</span>;
  }
}

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> {
  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">name</span>, <span style="color:#a6e22e">address</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span>    <span style="color:#f92672">=</span> <span style="color:#a6e22e">name</span>;
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">address</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">address</span>;
  }
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">printAddress</span>(<span style="color:#a6e22e">person</span>) {
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>([
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">street</span><span style="color:#f92672">?</span>,
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">state</span><span style="color:#f92672">?</span>,
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">country</span>
  ].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39;\n&#39;</span>));
}

<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">address</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">UsaAddress</span>(<span style="color:#e6db74">&#39;123 Foo St.&#39;</span>, <span style="color:#e6db74">&#39;New York&#39;</span>);
<span style="color:#66d9ef">let</span> <span style="color:#a6e22e">andrea</span>  <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Person</span>(<span style="color:#e6db74">&#39;Andrea&#39;</span>, <span style="color:#a6e22e">address</span>),
<span style="color:#a6e22e">printAddress</span>(<span style="color:#a6e22e">andrea</span>);
</code></pre></div><p>So what&rsquo;s wrong here?</p>
<p>Our <code>printAddress</code> function assumes several things about a person:</p>
<ol>
<li>that the person has an address property</li>
<li>that the address has a state property</li>
</ol>
<p>So what?</p>
<blockquote>
<p><em>Hey team! We&rsquo;ve got new business!!! We&rsquo;re going to be supporting Canadian addresses!</em></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CanadaAddress</span> {
  <span style="color:#a6e22e">constructor</span>(<span style="color:#a6e22e">street</span>, <span style="color:#a6e22e">province</span>, <span style="color:#a6e22e">country</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">street</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">street</span>;
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">province</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">province</span>; <span style="color:#75715e">// üëà difference
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">country</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Canada&#34;</span>;
  }
}
</code></pre></div><p>What most of us do to support this new use case:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">printAddress</span>(<span style="color:#a6e22e">person</span>) {
  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>([
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">street</span><span style="color:#f92672">?</span>,
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">state</span><span style="color:#f92672">?</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">province</span><span style="color:#f92672">?</span>, <span style="color:#75715e">// ‚ö†Ô∏è
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">country</span>
  ].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39;\n&#39;</span>));
}

<span style="color:#75715e">// - OR - ü§Æ
</span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">printAddress</span>(<span style="color:#a6e22e">person</span>) {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">constructor</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;UsaAddress&#34;</span>) {
    <span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">state</span>;
  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">constructor</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;CanadianAddress&#34;</span>) {
    <span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">province</span>;
  } <span style="color:#66d9ef">else</span> {
    <span style="color:#a6e22e">state</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
  }

  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>([
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">street</span><span style="color:#f92672">?</span>,
    <span style="color:#a6e22e">state</span>,
    <span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span>.<span style="color:#a6e22e">country</span>
  ].<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39;\n&#39;</span>));
}
</code></pre></div><p>Guess what happens when we need to support another type of address&hellip;</p>
<p>The <code>printAddress</code> function has dependencies that aren&rsquo;t passed into it:</p>
<ol>
<li>address</li>
<li>state and province on an address</li>
</ol>
<p>This function knows about something that is <strong>two degrees of separation</strong> away from itself, and if it changes, which the introduction of Canadian addresses introduces, our <code>printAddress</code> must change, too. This is tight-coupling &ndash; this function must move in lock-step with any address changes. It&rsquo;s rigid. It likely also requires updates to unit-tests if there were any to begin with. Touching existing code can always introduce a regression as well.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">          <span style="color:#960050;background-color:#1e0010">üëá</span> <span style="color:#75715e">// one degree of separation
</span><span style="color:#75715e"></span><span style="color:#a6e22e">person</span>.<span style="color:#a6e22e">address</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">state</span><span style="color:#f92672">?</span>
                   <span style="color:#960050;background-color:#1e0010">üëÜ</span> <span style="color:#75715e">// two degrees of separation
</span></code></pre></div><p>How do we fix this? Follow the <strong>Law of Demeter</strong> which simply states:</p>
<blockquote>
<p><strong>Each unit should have only limited knowledge about other units: only units &ldquo;closely&rdquo; related to the current unit.</strong></p>
</blockquote>
<blockquote>
<p><strong>Each unit should only talk to its friends; don&rsquo;t talk to strangers.</strong></p>
</blockquote>
<blockquote>
<p><strong>Only talk to your immediate friends.</strong></p>
</blockquote>
<p>With the above guidelines, we can interpret it to say, <em>&ldquo;a function should only know about things that are about a degree of separation away&rdquo;</em>.</p>
<p>We&rsquo;ll talk about how to fix this in a follow up post.</p>

    </div>
    


    
      
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user"><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></div>
    
  </div>
</footer>

<script src="https://wulymammoth.github.io/assets/main.js"></script>
<script src="https://wulymammoth.github.io/assets/prism.js"></script>


      
    </div>

    
  </body>
</html>
